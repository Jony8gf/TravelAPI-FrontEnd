{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jony8\\\\OneDrive\\\\Documentos\\\\AP.NET-CORE\\\\react-travel\\\\src\\\\viajes\\\\FiltroViajes.tsx\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport { Form, Formik } from \"formik\";\nimport { useEffect, useState } from \"react\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport Button from \"utils/Button\";\nimport { urlPromocion, urlTipoActividad, urlViajes } from \"utils/endpoints\";\nimport Paginacion from \"utils/Paginacion\";\nimport ListadoViajes from \"./ListadoViajes\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function FiltroViajes() {\n  _s();\n\n  const valorInicial = {\n    pais: '',\n    lugar: '',\n    promocionId: 0,\n    tipoActividadId: 0,\n    pagina: 1,\n    recordsPorPagina: 10\n  };\n  const [tipoActividades, setTipoActividades] = useState([]);\n  const [promociones, setPromociones] = useState([]);\n  const [viajes, setViajes] = useState([]);\n  const history = useHistory();\n  const [errores, setErrores] = useState([]);\n  const query = new URLSearchParams(useLocation().search);\n  const [totalDePaginas, setTotalDePaginas] = useState(0);\n  useEffect(() => {\n    axios.get(`${urlPromocion}/todos`).then(respuesta => {\n      setPromociones(respuesta.data);\n    });\n  }, []);\n  useEffect(() => {\n    axios.get(`${urlTipoActividad}/todos`).then(respuesta => {\n      setTipoActividades(respuesta.data);\n    });\n  }, []);\n  useEffect(() => {\n    if (query.get('lugar')) {\n      valorInicial.lugar = query.get('lugar');\n    }\n\n    if (query.get('pais')) {\n      valorInicial.pais = query.get('pais');\n    }\n\n    if (query.get('tipoActividadId')) {\n      valorInicial.tipoActividadId = parseInt(query.get('tipoActividadId'), 10);\n    }\n\n    if (query.get('promocionId')) {\n      valorInicial.promocionId = parseInt(query.get('promocionId'), 10);\n    }\n\n    if (query.get('pagina')) {\n      valorInicial.pagina = parseInt(query.get('pagina'), 10);\n    }\n\n    buscarViajes(valorInicial); //eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  function buscarViajes(valores) {\n    modificarURL(valores);\n    axios.get(`${urlViajes}/filtrar`, {\n      params: valores\n    }).then(respuesta => {\n      const totalDeRegistros = parseInt(respuesta.headers['cantidadtotalregistros'], 10);\n      setTotalDePaginas(Math.ceil(totalDeRegistros / valorInicial.recordsPorPagina));\n      setViajes(respuesta.data);\n    });\n  }\n\n  function modificarURL(valores) {\n    const queryStrings = [];\n\n    if (valores.pais) {\n      queryStrings.push(`pais=${valores.pais}`);\n    }\n\n    if (valores.lugar) {\n      queryStrings.push(`lugar=${valores.lugar}`);\n    }\n\n    if (valores.promocionId !== 0) {\n      queryStrings.push(`promocionId=${valores.promocionId}`);\n    }\n\n    if (valores.tipoActividadId) {\n      queryStrings.push(`tipoActividadId=${valores.tipoActividadId}`);\n    }\n\n    queryStrings.push(`pagina=${valores.pagina}`);\n    history.push(`/viajes/filtrar?${queryStrings.join('&')}`);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Filtrar Viajes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Formik, {\n      initialValues: valorInicial,\n      onSubmit: valores => {\n        valores.pagina = 1;\n        buscarViajes(valores);\n      },\n      children: formikProps => /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Form, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-inline\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"pais\",\n                className: \"sr-only\",\n                children: \"Pais\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                className: \"form-control\",\n                id: \"pais\",\n                placeholder: \"Pais\",\n                ...formikProps.getFieldProps('pais')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"lugar\",\n                className: \"sr-only\",\n                children: \"Lugar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                className: \"form-control\",\n                id: \"lugar\",\n                placeholder: \"Lugar\",\n                ...formikProps.getFieldProps('lugar')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group mx-sm-3 mb-2\",\n              children: /*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"form-control\",\n                ...formikProps.getFieldProps('tipoActividadId'),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"0\",\n                  children: \"--Seleccione un Tipo de Actividad--\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 140,\n                  columnNumber: 37\n                }, this), tipoActividades.map(actividad => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: actividad.id,\n                  children: actividad.nombre\n                }, actividad.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 71\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group mx-sm-3 mb-2\",\n              children: /*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"form-control\",\n                ...formikProps.getFieldProps('generoId'),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"0\",\n                  children: \"--Seleccione una Promoci\\xF3n--\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 37\n                }, this), promociones.map(promocion => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: promocion.id,\n                  children: promocion.nombre\n                }, promocion.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 67\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn btn-primary mb-2 mx-sm-3\",\n              onClick: () => formikProps.submitForm(),\n              children: \"Filtrar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn btn-danger mb-2\",\n              onClick: () => {\n                formikProps.setValues(valorInicial);\n                buscarViajes(valorInicial);\n              },\n              children: \"Limpiar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ListadoViajes, {\n          viajes: viajes\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Paginacion, {\n          paginaActual: formikProps.values.pagina,\n          onChange: nuevaPagina => {\n            formikProps.values.pagina = nuevaPagina;\n            buscarViajes(formikProps.values);\n          },\n          cantidadTotalDePaginas: totalDePaginas\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s(FiltroViajes, \"vEsbUxISscx6jhgLfIKAGLuMAhM=\", false, function () {\n  return [useHistory, useLocation];\n});\n\n_c = FiltroViajes;\n\nvar _c;\n\n$RefreshReg$(_c, \"FiltroViajes\");","map":{"version":3,"sources":["C:/Users/jony8/OneDrive/Documentos/AP.NET-CORE/react-travel/src/viajes/FiltroViajes.tsx"],"names":["axios","Form","Formik","useEffect","useState","useHistory","useLocation","Button","urlPromocion","urlTipoActividad","urlViajes","Paginacion","ListadoViajes","FiltroViajes","valorInicial","pais","lugar","promocionId","tipoActividadId","pagina","recordsPorPagina","tipoActividades","setTipoActividades","promociones","setPromociones","viajes","setViajes","history","errores","setErrores","query","URLSearchParams","search","totalDePaginas","setTotalDePaginas","get","then","respuesta","data","parseInt","buscarViajes","valores","modificarURL","params","totalDeRegistros","headers","Math","ceil","queryStrings","push","join","formikProps","getFieldProps","map","actividad","id","nombre","promocion","submitForm","setValues","values","nuevaPagina"],"mappings":"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","sourcesContent":["import axios, { AxiosResponse } from \"axios\";\r\nimport { Field, Form, Formik } from \"formik\";\r\nimport { promocionDTO } from \"promociones/promociones.model\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useHistory, useLocation } from \"react-router-dom\";\r\nimport { tipoActividadDTO } from \"tipoActividad/tipoactividad.model\";\r\nimport Button from \"utils/Button\";\r\nimport { urlPromocion, urlTipoActividad, urlViajes } from \"utils/endpoints\";\r\nimport Paginacion from \"utils/Paginacion\";\r\nimport ListadoViajes from \"./ListadoViajes\";\r\nimport { viajeDTO } from \"./viajes.model\";\r\n\r\nexport default function FiltroViajes() {\r\n\r\n    const valorInicial: filtroViajesForm = {\r\n        pais: '',\r\n        lugar: '',\r\n        promocionId: 0,\r\n        tipoActividadId: 0,\r\n        pagina: 1,\r\n        recordsPorPagina: 10\r\n    }\r\n\r\n    const [tipoActividades, setTipoActividades] = useState<tipoActividadDTO[]>([]);\r\n    const [promociones, setPromociones] = useState<promocionDTO[]>([]);\r\n    const [viajes, setViajes] = useState<viajeDTO[]>([]);\r\n    const history = useHistory();\r\n    const [errores, setErrores] = useState<string[]>([]);\r\n    const query = new URLSearchParams(useLocation().search)\r\n    const [totalDePaginas, setTotalDePaginas] = useState(0);\r\n\r\n    useEffect(() => {\r\n        axios.get(`${urlPromocion}/todos`)\r\n        .then((respuesta: AxiosResponse<promocionDTO[]>) => {\r\n            setPromociones(respuesta.data);\r\n        })\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        axios.get(`${urlTipoActividad}/todos`)\r\n        .then((respuesta: AxiosResponse<tipoActividadDTO[]>) => {\r\n            setTipoActividades(respuesta.data);\r\n        })\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n\r\n        if(query.get('lugar')){\r\n            valorInicial.lugar = query.get('lugar')!;\r\n        }\r\n\r\n        if(query.get('pais')){\r\n            valorInicial.pais = query.get('pais')!;\r\n        }\r\n\r\n        if(query.get('tipoActividadId')){\r\n            valorInicial.tipoActividadId = parseInt(query.get('tipoActividadId')!, 10);\r\n        }\r\n\r\n        if(query.get('promocionId')){\r\n            valorInicial.promocionId = parseInt(query.get('promocionId')!, 10);\r\n        }\r\n\r\n        if(query.get('pagina')){\r\n            valorInicial.pagina = parseInt(query.get('pagina')!, 10);\r\n        }\r\n\r\n        buscarViajes(valorInicial);\r\n        //eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [])\r\n\r\n    function buscarViajes(valores: filtroViajesForm){\r\n        modificarURL(valores);\r\n        axios.get(`${urlViajes}/filtrar`, {params: valores})\r\n        .then((respuesta: AxiosResponse<viajeDTO[]>) => {\r\n            const totalDeRegistros =\r\n                    parseInt(respuesta.headers['cantidadtotalregistros'], 10);\r\n            setTotalDePaginas(Math.ceil(totalDeRegistros / valorInicial.recordsPorPagina))\r\n            setViajes(respuesta.data);\r\n        })\r\n    }\r\n\r\n    function modificarURL(valores: filtroViajesForm){\r\n        const queryStrings: string[] = [];\r\n        if(valores.pais){\r\n            queryStrings.push(`pais=${valores.pais}`)\r\n        }\r\n\r\n        if(valores.lugar){\r\n            queryStrings.push(`lugar=${valores.lugar}`)\r\n        }\r\n\r\n        if(valores.promocionId !==  0){\r\n            queryStrings.push(`promocionId=${valores.promocionId}`)\r\n        }\r\n\r\n        if(valores.tipoActividadId){\r\n            queryStrings.push(`tipoActividadId=${valores.tipoActividadId}`)\r\n        }\r\n\r\n        queryStrings.push(`pagina=${valores.pagina}`);\r\n        history.push(`/viajes/filtrar?${queryStrings.join('&')}`)\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            <h3>Filtrar Viajes</h3>\r\n\r\n            <Formik initialValues={valorInicial}\r\n                onSubmit={valores => {\r\n                    valores.pagina = 1;\r\n                    buscarViajes(valores)\r\n                }}\r\n            >\r\n                {(formikProps) => (\r\n                    <>\r\n                    <Form>\r\n                        <div className=\"form-inline\">\r\n                            <div className=\"form-group mb-2\">\r\n                                <label htmlFor=\"pais\" className=\"sr-only\">Pais</label>\r\n                                <input type=\"text\"\r\n                                    className=\"form-control\" id=\"pais\"\r\n                                    placeholder=\"Pais\"\r\n                                    {...formikProps.getFieldProps('pais')}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group mb-2\">\r\n                                <label htmlFor=\"lugar\" className=\"sr-only\">Lugar</label>\r\n                                <input type=\"text\"\r\n                                    className=\"form-control\" id=\"lugar\"\r\n                                    placeholder=\"Lugar\"\r\n                                    {...formikProps.getFieldProps('lugar')}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group mx-sm-3 mb-2\">\r\n                                <select className=\"form-control\"\r\n                                    {...formikProps.getFieldProps('tipoActividadId')}\r\n                                >\r\n                                    <option value=\"0\">--Seleccione un Tipo de Actividad--</option>\r\n                                    {tipoActividades.map(actividad => <option key={actividad.id}\r\n                                        value={actividad.id}>{actividad.nombre}</option>)}\r\n                                </select>\r\n                            </div>\r\n                            <div className=\"form-group mx-sm-3 mb-2\">\r\n                                <select className=\"form-control\"\r\n                                    {...formikProps.getFieldProps('generoId')}\r\n                                >\r\n                                    <option value=\"0\">--Seleccione una Promoción--</option>\r\n                                    {promociones.map(promocion => <option key={promocion.id}\r\n                                        value={promocion.id}>{promocion.nombre}</option>)}\r\n                                </select>\r\n                            </div>\r\n                            <Button\r\n                            className=\"btn btn-primary mb-2 mx-sm-3\"\r\n                             onClick={() => formikProps.submitForm()}\r\n                            >Filtrar</Button>\r\n                            <Button\r\n                                className=\"btn btn-danger mb-2\"\r\n                                onClick={() => {\r\n                                    formikProps.setValues(valorInicial);\r\n                                    buscarViajes(valorInicial)\r\n                                }}\r\n                            >Limpiar</Button>\r\n                        </div>\r\n                    </Form>\r\n\r\n                    <ListadoViajes viajes={viajes} />\r\n\r\n                    <Paginacion\r\n                        paginaActual={formikProps.values.pagina}\r\n                        onChange={nuevaPagina => {\r\n                            formikProps.values.pagina = nuevaPagina;\r\n                            buscarViajes(formikProps.values)\r\n                        }}\r\n                        cantidadTotalDePaginas={totalDePaginas}\r\n                    ></Paginacion>\r\n                    </>\r\n                )}\r\n            </Formik>\r\n\r\n            \r\n\r\n        </>\r\n\r\n    )\r\n}\r\n\r\ninterface filtroViajesForm {\r\n    pais: string;\r\n    lugar: string;\r\n    tipoActividadId: number;\r\n    promocionId: number;\r\n    pagina: number;\r\n    recordsPorPagina: number;\r\n}"]},"metadata":{},"sourceType":"module"}